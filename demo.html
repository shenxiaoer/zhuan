<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title></title>
    <script src="js/jquery-2.1.4.js"></script>
</head>
<body>
    <div class="btn">
        <img src="images/1.png" alt=""/>
    </div>
    <div class="btn">
        <img src="images/1.png" alt=""/>
    </div>
    <div class="btn">
        <img src="images/1.png" alt=""/>
    </div>
    <script>
        $(".btn").one("click",function(){
            //if(!$(this).data("flag")){
               // $(this).data("flag","true");
                var img=$(this).children("img");
                img.attr("src","images/11.gif");
                setTimeout(function(){
                    img.attr("src","images/2.png");
                    console.log($(this));
                },3000)
            //
        })
        /*//运动事件监听
        if (window.DeviceMotionEvent) {
            window.addEventListener('devicemotion',deviceMotionHandler,false);
        }

        //获取加速度信息
        //通过监听上一步获取到的x, y, z 值在一定时间范围内的变化率，进行设备是否有进行晃动的判断。
        //而为了防止正常移动的误判，需要给该变化率设置一个合适的临界值。
        var SHAKE_THRESHOLD = 4000;
        var last_update = 0;
        var x, y, z, last_x = 0, last_y = 0, last_z = 0;
        function deviceMotionHandler(eventData) {
            var acceleration =eventData.accelerationIncludingGravity;
            var curTime = new Date().getTime();
            if ((curTime-last_update)> 10) {
                var diffTime = curTime -last_update;
                last_update = curTime;
                x = acceleration.x;
                y = acceleration.y;
                z = acceleration.z;
                var speed = Math.abs(x +y + z - last_x - last_y - last_z) / diffTime * 10000;
                if (speed > SHAKE_THRESHOLD) {
                    alert("你中奖啦！");  // Do something
                }
                last_x = x;
                last_y = y;
                last_z = z;
            }
        }*/
    </script>

    <script>
        var speed = 10; //定义摇一摇加速度的临界值 值越小摇动的力度越小
        var x = y = z = lastX = lastY = lastZ = 0; //初始化x,y,z上加速度的默认值
          var isHaveShaked = false;//用于记录是否在动画执行中
          function init() {
           //判断系统是否支持html5摇一摇的相关属性
            if (window.DeviceMotionEvent) {
                  window.addEventListener('devicemotion', deviceMotionHandler, false);
                } else {
                  alert('not support mobile event');
                }
              }
        function deviceMotionHandler() {
            /*获取x,y,z方向的即时加速度*/
            var acceleration = event.accelerationIncludingGravity;
            x = acceleration.x;
            y = acceleration.y;
            z = acceleration.z;
            if (Math.abs(x - lastX) &gt; speed || Math.abs(y - lastY) &gt; speed
                      || Math.abs(z - lastZ) &gt; speed) {
              //摇一摇实际场景就是加速度的瞬间暴增爆减
              if (!isHaveShaked) {
                  alert(x); //自己测试各坐标的值。。
                  alert(y)
                      alert(z);
                      //手机震动1秒
                  if (navigator.vibrate) {
                        navigator.vibrate(1000);//震动1000毫秒
                      } else if (navigator.webkitVibrate) {
                        navigator.webkitVibrate(1000);
                      }
                      //模拟网络请求做想干的事
                  isHaveShaked = true;
                      setTimeout(function () {
                        isHaveShaked = false;
                        //.....      
                          }, 2000);
                      }
                }
            /*保存历史加速度*/
            lastX = x;
            lastY = y;
            lastZ = z;
          }
          $(function () {
            init();
          });
        
    </script>
</body>
</html>